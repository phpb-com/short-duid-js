.job_template: &job_definition
  type: test
  script:
  - node -v
  - npm install
  - npm test
  - cat /proc/cpuinfo | grep "^model name" | uniq
  - npm run-script bench

before_script:
  - uname -a

types:
  - test
  - release

node-latest:
  image: node:latest
  <<: *job_definition

release:
  variables:
    NPM_TOKEN: ${NPM_TOKEN}
  type: release
  image: node:latest
  script:
  - npm publish
  only:
  - tags
